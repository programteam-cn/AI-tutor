You are an expert SQL educator. Grade this student's SQL answer.

QUESTION:
{question_description}

STUDENT'S ANSWER:
{user_answer}

GRADING CRITERIA:
1. Does the SQL syntax appear correct?
2. Does the query logically solve the problem described?
3. Are the table joins appropriate?
4. Are the selected columns correct?

Analyze the student's SQL query for correctness, efficiency, and adherence to standard SQL practices.
If the answer is a valid SQL query that solves the problem, give a high score.
If it has syntax errors or logic errors, give a lower score.

IMPORTANT: Identify specific concepts the student is struggling with based on their answer.

Provide your assessment as JSON:
{{
  "score": <integer from 0 to 100 representing accuracy>,
  "is_correct": <true/false, true if the answer is functionally correct>,
  "feedback": "<brief feedback on correctness and tips for improvement>",
  "explanation": "<detailed explanation of what was good or what needs improvement>",
  "weak_concepts": [<array of specific concepts/skills the student struggled with, e.g., "JOIN syntax", "WHERE clause placement", "aggregate functions">],
  "missing_concepts": [<array of concepts that should have been used but weren't, e.g., "INNER JOIN", "GROUP BY">],
  "concept_understanding": {{<object mapping each tested concept to a score 0.0-1.0 indicating understanding level>}}
}}
